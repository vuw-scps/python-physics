


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.4.0">
    
    
      
        <title>Numerical Differentiation - python-physics</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fe0cca5b.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#numerical-differentiation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="python-physics" class="md-header-nav__button md-logo" aria-label="python-physics">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            python-physics
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Numerical Differentiation
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="python-physics" class="md-nav__button md-logo" aria-label="python-physics">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    python-physics
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Welcome to MkDocs" class="md-nav__link">
      Welcome to MkDocs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Differential equations
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Differential equations" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Differential equations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../differential-equations/first-order/" title="First Order Equations" class="md-nav__link">
      First Order Equations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Differentiation
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Differentiation" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Differentiation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Numerical Differentiation
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Numerical Differentiation" class="md-nav__link md-nav__link--active">
      Numerical Differentiation
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#derivative" class="md-nav__link">
    Derivative
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#difference-formulas" class="md-nav__link">
    Difference Formulas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    Implementation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-formulas" class="md-nav__link">
    Error Formulas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scipymiscderivative" class="md-nav__link">
    scipy.misc.derivative
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#higher-order-derivatives" class="md-nav__link">
    Higher Order Derivatives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#taylor-series" class="md-nav__link">
    Taylor series
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arc-length" class="md-nav__link">
    Arc length
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercises" class="md-nav__link">
    Exercises
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Integration
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Integration" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Integration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../integration/integrals/" title="Definite Integrals" class="md-nav__link">
      Definite Integrals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integration/riemann-sums/" title="Riemann Sums" class="md-nav__link">
      Riemann Sums
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integration/simpsons-rule/" title="Simpson's Rule" class="md-nav__link">
      Simpson's Rule
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integration/trapezoid-rule/" title="Trapezoid Rule" class="md-nav__link">
      Trapezoid Rule
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Jupyter
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Jupyter" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Jupyter
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../jupyter/latex/" title="LaTeX" class="md-nav__link">
      LaTeX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../jupyter/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../jupyter/notebook/" title="Jupyter Notebook" class="md-nav__link">
      Jupyter Notebook
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Linear algebra
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Linear algebra" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Linear algebra
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../linear-algebra/applications/" title="Applications" class="md-nav__link">
      Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linear-algebra/eigenvalues-eigenvectors/" title="Eigenvalues and Eigenvectors" class="md-nav__link">
      Eigenvalues and Eigenvectors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linear-algebra/linear-algebra-scipy/" title="Linear Algebra with SciPy" class="md-nav__link">
      Linear Algebra with SciPy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linear-algebra/solving-linear-systems/" title="Solving Linear Systems" class="md-nav__link">
      Solving Linear Systems
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Problems
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Problems" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Problems
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../problems/problems/" title="Problems" class="md-nav__link">
      Problems
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Python
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Python" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/functions/" title="Functions" class="md-nav__link">
      Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/logic/" title="Logic" class="md-nav__link">
      Logic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/loops/" title="Loops" class="md-nav__link">
      Loops
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/modules-packages/" title="Modules and Packages" class="md-nav__link">
      Modules and Packages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/numbers/" title="Numbers" class="md-nav__link">
      Numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/sequences/" title="Sequences" class="md-nav__link">
      Sequences
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/text/" title="Text" class="md-nav__link">
      Text
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/variables/" title="Variables" class="md-nav__link">
      Variables
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Roots optimization
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Roots optimization" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Roots optimization
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../roots-optimization/bisection/" title="Bisection Method" class="md-nav__link">
      Bisection Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../roots-optimization/newton/" title="Newton's Method" class="md-nav__link">
      Newton's Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../roots-optimization/root-finding/" title="Root Finding" class="md-nav__link">
      Root Finding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../roots-optimization/secant/" title="Secant Method" class="md-nav__link">
      Secant Method
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Scipy
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Scipy" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Scipy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../scipy/matplotlib/" title="Matplotlib" class="md-nav__link">
      Matplotlib
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scipy/numpy/" title="NumPy" class="md-nav__link">
      NumPy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scipy/scipy/" title="SciPy" class="md-nav__link">
      SciPy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#derivative" class="md-nav__link">
    Derivative
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#difference-formulas" class="md-nav__link">
    Difference Formulas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    Implementation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-formulas" class="md-nav__link">
    Error Formulas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scipymiscderivative" class="md-nav__link">
    scipy.misc.derivative
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#higher-order-derivatives" class="md-nav__link">
    Higher Order Derivatives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#taylor-series" class="md-nav__link">
    Taylor series
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arc-length" class="md-nav__link">
    Arc length
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercises" class="md-nav__link">
    Exercises
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="numerical-differentiation">Numerical Differentiation</h1>
<pre><code class="python">import numpy as np
import matplotlib.pyplot as plt
%matplotlib inline
</code></pre>

<h2 id="derivative">Derivative</h2>
<p>The derivative of a function <span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> at <span><span class="MathJax_Preview">x=a</span><script type="math/tex">x=a</script></span> is the limit</p>
<div>
<div class="MathJax_Preview">
f'(a) = \lim_{h \to 0} \frac{f(a+h) - f(a)}{h}
</div>
<script type="math/tex; mode=display">
f'(a) = \lim_{h \to 0} \frac{f(a+h) - f(a)}{h}
</script>
</div>
<h2 id="difference-formulas">Difference Formulas</h2>
<p>There are 3 main <a href="https://en.wikipedia.org/wiki/Finite_difference#Forward,_backward,_and_central_differences">difference formulas</a> for numerically approximating derivatives.</p>
<p>The <em>forward difference formula</em> with step size <span><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span> is</p>
<div>
<div class="MathJax_Preview">
f'(a) \approx \frac{f(a + h) - f(a)}{h}
</div>
<script type="math/tex; mode=display">
f'(a) \approx \frac{f(a + h) - f(a)}{h}
</script>
</div>
<p>The <em>backward difference formula</em> with step size <span><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span> is</p>
<div>
<div class="MathJax_Preview">
f'(a) \approx \frac{f(a) - f(a - h)}{h}
</div>
<script type="math/tex; mode=display">
f'(a) \approx \frac{f(a) - f(a - h)}{h}
</script>
</div>
<p>The <em>central difference formula</em> with step size <span><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span> is the average of the forward and backwards difference formulas</p>
<div>
<div class="MathJax_Preview">
f'(a) \approx \frac{1}{2} \left( \frac{f(a + h) - f(a)}{h} + \frac{f(a) - f(a - h)}{h} \right) = \frac{f(a + h) - f(a - h)}{2h}
</div>
<script type="math/tex; mode=display">
f'(a) \approx \frac{1}{2} \left( \frac{f(a + h) - f(a)}{h} + \frac{f(a) - f(a - h)}{h} \right) = \frac{f(a + h) - f(a - h)}{2h}
</script>
</div>
<h2 id="implementation">Implementation</h2>
<p>Let's write a function called <code>derivative</code> which takes input parameters <code>f</code>, <code>a</code>, <code>method</code> and <code>h</code> (with default values <code>method='central'</code> and <code>h=0.01</code>) and returns the corresponding difference formula for <span><span class="MathJax_Preview">f'(a)</span><script type="math/tex">f'(a)</script></span> with step size <span><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>.</p>
<pre><code class="python">def derivative(f,a,method='central',h=0.01):
    '''Compute the difference formula for f'(a) with step size h.

    Parameters
    ----------
    f : function
        Vectorized function of one variable
    a : number
        Compute derivative at x = a
    method : string
        Difference formula: 'forward', 'backward' or 'central'
    h : number
        Step size in difference formula

    Returns
    -------
    float
        Difference formula:
            central: f(a+h) - f(a-h))/2h
            forward: f(a+h) - f(a))/h
            backward: f(a) - f(a-h))/h            
    '''
    if method == 'central':
        return (f(a + h) - f(a - h))/(2*h)
    elif method == 'forward':
        return (f(a + h) - f(a))/h
    elif method == 'backward':
        return (f(a) - f(a - h))/h
    else:
        raise ValueError(&quot;Method must be 'central', 'forward' or 'backward'.&quot;)
</code></pre>

<p>Let's test our function on some simple functions. For example, we know</p>
<div>
<div class="MathJax_Preview">
\left. \frac{d}{dx} \left( \cos x \right) \, \right|_{x=0} = -\sin(0) = 0
</div>
<script type="math/tex; mode=display">
\left. \frac{d}{dx} \left( \cos x \right) \, \right|_{x=0} = -\sin(0) = 0
</script>
</div>
<p>and we compute</p>
<pre><code class="python">derivative(np.cos,0)
</code></pre>

<div class="highlight"><pre><span></span><code>0.0
</code></pre></div>

<pre><code class="python">derivative(np.cos,0,method='forward',h=1e-8)
</code></pre>

<div class="highlight"><pre><span></span><code>0.0
</code></pre></div>

<p>We also know</p>
<div>
<div class="MathJax_Preview">
\left. \frac{d}{dx} \left( e^x \right) \, \right|_{x=0} = e^0 = 1
</div>
<script type="math/tex; mode=display">
\left. \frac{d}{dx} \left( e^x \right) \, \right|_{x=0} = e^0 = 1
</script>
</div>
<p>and we compute</p>
<pre><code class="python">derivative(np.exp,0,h=0.0001)
</code></pre>

<div class="highlight"><pre><span></span><code>1.0000000016668897
</code></pre></div>

<pre><code class="python">derivative(np.exp,0,method='backward',h=0.0001)
</code></pre>

<div class="highlight"><pre><span></span><code>0.9999500016666385
</code></pre></div>

<p>Notice that our function can take an array of inputs for <span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> and return the derivatives for each <span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> value. For example, we can plot the derivative of <span><span class="MathJax_Preview">\sin(x)</span><script type="math/tex">\sin(x)</script></span>:</p>
<pre><code class="python">x = np.linspace(0,5*np.pi,100)
dydx = derivative(np.sin,x)

dYdx = np.cos(x)

plt.figure(figsize=(12,5))
plt.plot(x,dydx,'r.',label='Central Difference')
plt.plot(x,dYdx,'b',label='True Value')

plt.title('Central Difference Derivative of y = cos(x)')
plt.legend(loc='best')
plt.show()
</code></pre>

<p><img alt="png" src="../../nb_img/differentiation/differentiation_13_0.png" /></p>
<p>Let's compute and plot the derivative of a complicated function</p>
<div>
<div class="MathJax_Preview">
y=\left(\frac{4x^2+2x+1}{x+2e^x}\right)^x
</div>
<script type="math/tex; mode=display">
y=\left(\frac{4x^2+2x+1}{x+2e^x}\right)^x
</script>
</div>
<pre><code class="python">x = np.linspace(0,6,100)
f = lambda x: ((4*x**2 + 2*x + 1)/(x + 2*np.exp(x)))**x
y = f(x)
dydx = derivative(f,x)

plt.figure(figsize=(12,5))
plt.plot(x,y,label='y=f(x)')
plt.plot(x,dydx,label=&quot;Central Difference y=f'(x)&quot;)
plt.legend()
plt.grid(True)

plt.show()
</code></pre>

<p><img alt="png" src="../../nb_img/differentiation/differentiation_15_0.png" /></p>
<h2 id="error-formulas">Error Formulas</h2>
<p>Natural questions arise: how good are the approximations given by the forward, backwards and central difference formulas? We derive the error formulas from <a href="https://en.wikipedia.org/wiki/Taylor%27s_theorem">Taylor's Theorem</a>.</p>
<hr />
<p><strong>Theorem.</strong> The degree <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> Taylor polynomial of <span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> at <span><span class="MathJax_Preview">x=a</span><script type="math/tex">x=a</script></span> with remainder term is</p>
<div>
<div class="MathJax_Preview">
f(x) = f(a) + f'(a)(x - a) + \frac{f''(a)}{2}(x-a)^2 + \cdots + \frac{f^{(n)}(a)}{n!}(x-a)^n + \frac{f^{(n+1)}(c)}{(n+1)!}(x-a)^{n+1}
</div>
<script type="math/tex; mode=display">
f(x) = f(a) + f'(a)(x - a) + \frac{f''(a)}{2}(x-a)^2 + \cdots + \frac{f^{(n)}(a)}{n!}(x-a)^n + \frac{f^{(n+1)}(c)}{(n+1)!}(x-a)^{n+1}
</script>
</div>
<p>for some value <span><span class="MathJax_Preview">c</span><script type="math/tex">c</script></span> between <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> and <span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span>.</p>
<hr />
<p><strong>Theorem.</strong> The forward difference formula error is</p>
<div>
<div class="MathJax_Preview">
\left| \, \frac{f(a+h) - f(a)}{h} - f'(a) \, \right| \leq \frac{hK_2}{2}
</div>
<script type="math/tex; mode=display">
\left| \, \frac{f(a+h) - f(a)}{h} - f'(a) \, \right| \leq \frac{hK_2}{2}
</script>
</div>
<p>where <span><span class="MathJax_Preview">\left| \, f''(x) \, \right| \leq K_2</span><script type="math/tex">\left| \, f''(x) \, \right| \leq K_2</script></span> for all <span><span class="MathJax_Preview">x \in [a,a+h]</span><script type="math/tex">x \in [a,a+h]</script></span>. The same error fomula holds for the backward difference formula.</p>
<p><em>Proof</em>. Look at the degree 1 Taylor formula:</p>
<div>
<div class="MathJax_Preview">
f(x) = f(a) + f'(a)(x-a) + \frac{f''(c)}{2}(x-a)^{2}
</div>
<script type="math/tex; mode=display">
f(x) = f(a) + f'(a)(x-a) + \frac{f''(c)}{2}(x-a)^{2}
</script>
</div>
<p>Let <span><span class="MathJax_Preview">x = a+h</span><script type="math/tex">x = a+h</script></span> and manipulate the formula</p>
<div>
<div class="MathJax_Preview">\begin{align}
f(a+h) &amp;= f(a) + f'(a)h + \frac{f''(c)}{2}h^{2} \\\
f(a+h) - f(a) &amp;= f'(a)h + \frac{f''(c)}{2}h^{2} \\\
\frac{f(a+h) - f(a)}{h} &amp;= f'(a) + \frac{f''(c)}{2}h \\\
\frac{f(a+h) - f(a)}{h} - f'(a) &amp;= \frac{f''(c)}{2}h
\end{align}</div>
<script type="math/tex; mode=display">\begin{align}
f(a+h) &= f(a) + f'(a)h + \frac{f''(c)}{2}h^{2} \\\
f(a+h) - f(a) &= f'(a)h + \frac{f''(c)}{2}h^{2} \\\
\frac{f(a+h) - f(a)}{h} &= f'(a) + \frac{f''(c)}{2}h \\\
\frac{f(a+h) - f(a)}{h} - f'(a) &= \frac{f''(c)}{2}h
\end{align}</script>
</div>
<p>Let <span><span class="MathJax_Preview">K_2</span><script type="math/tex">K_2</script></span> such that <span><span class="MathJax_Preview">\left| \, f''(x) \, \right| \leq K_2</span><script type="math/tex">\left| \, f''(x) \, \right| \leq K_2</script></span> for all <span><span class="MathJax_Preview">x \in [a,a+h]</span><script type="math/tex">x \in [a,a+h]</script></span> and we see the result.</p>
<hr />
<p><strong>Theorem.</strong> The central difference formula error is:</p>
<div>
<div class="MathJax_Preview">
\left| \frac{f(a+h) - f(a-h)}{2h} - f'(a) \right| \leq \frac{h^2K_3}{6}
</div>
<script type="math/tex; mode=display">
\left| \frac{f(a+h) - f(a-h)}{2h} - f'(a) \right| \leq \frac{h^2K_3}{6}
</script>
</div>
<p>where <span><span class="MathJax_Preview">|f'''(x)| \leq K_3</span><script type="math/tex">|f'''(x)| \leq K_3</script></span> for all <span><span class="MathJax_Preview">x \in [a-h,a+h]</span><script type="math/tex">x \in [a-h,a+h]</script></span>.</p>
<p><em>Proof</em>. Look at the Taylor polynomial of degree 2:</p>
<div>
<div class="MathJax_Preview">
f(x) = f(a) + f'(a)(x-a) + \frac{f''(a)}{2}(x-a)^2 + \frac{f'''(c)}{6}(x-a)^{3}
</div>
<script type="math/tex; mode=display">
f(x) = f(a) + f'(a)(x-a) + \frac{f''(a)}{2}(x-a)^2 + \frac{f'''(c)}{6}(x-a)^{3}
</script>
</div>
<p>Let <span><span class="MathJax_Preview">x = a + h</span><script type="math/tex">x = a + h</script></span> and also <span><span class="MathJax_Preview">x = a - h</span><script type="math/tex">x = a - h</script></span> and write:</p>
<div>
<div class="MathJax_Preview">\begin{align}
f(a+h) &amp;= f(a) + f'(a)h + \frac{f''(a)}{2}h^2 + \frac{f'''(c_1)}{6}h^{3} \\\
f(a-h) &amp;= f(a) - f'(a)h + \frac{f''(a)}{2}h^2 - \frac{f'''(c_2)}{6}h^{3} \\\
f(a+h) - f(a-h) &amp;= 2 f'(a)h + \frac{f'''(c_1)}{6}h^{3} + \frac{f'''(c_2)}{6}h^{3} \\\
\frac{f(a+h) - f(a-h)}{2h} - f'(a) &amp;= \frac{f'''(c_1) + f'''(c_2)}{12}h^{2}
\end{align}</div>
<script type="math/tex; mode=display">\begin{align}
f(a+h) &= f(a) + f'(a)h + \frac{f''(a)}{2}h^2 + \frac{f'''(c_1)}{6}h^{3} \\\
f(a-h) &= f(a) - f'(a)h + \frac{f''(a)}{2}h^2 - \frac{f'''(c_2)}{6}h^{3} \\\
f(a+h) - f(a-h) &= 2 f'(a)h + \frac{f'''(c_1)}{6}h^{3} + \frac{f'''(c_2)}{6}h^{3} \\\
\frac{f(a+h) - f(a-h)}{2h} - f'(a) &= \frac{f'''(c_1) + f'''(c_2)}{12}h^{2}
\end{align}</script>
</div>
<p>Notice that <span><span class="MathJax_Preview">f'''(x)</span><script type="math/tex">f'''(x)</script></span> is continuous (by assumption) and <span><span class="MathJax_Preview">(f'''(c_1) + f'''(c_2))/2</span><script type="math/tex">(f'''(c_1) + f'''(c_2))/2</script></span> is between <span><span class="MathJax_Preview">f'''(c_1)</span><script type="math/tex">f'''(c_1)</script></span> and <span><span class="MathJax_Preview">f'''(c_2)</span><script type="math/tex">f'''(c_2)</script></span> and so there exists some <span><span class="MathJax_Preview">c</span><script type="math/tex">c</script></span> between <span><span class="MathJax_Preview">c_1</span><script type="math/tex">c_1</script></span> and <span><span class="MathJax_Preview">c_2</span><script type="math/tex">c_2</script></span> such that</p>
<div>
<div class="MathJax_Preview">
f'''(c) = \frac{f'''(c_1) + f'''(c_2)}{2}
</div>
<script type="math/tex; mode=display">
f'''(c) = \frac{f'''(c_1) + f'''(c_2)}{2}
</script>
</div>
<p>by the Intermediate Value Theorem. Let <span><span class="MathJax_Preview">K_3</span><script type="math/tex">K_3</script></span> such that <span><span class="MathJax_Preview">\left| \, f'''(x) \, \right| \leq K_3</span><script type="math/tex">\left| \, f'''(x) \, \right| \leq K_3</script></span> for all <span><span class="MathJax_Preview">x \in [a-h,a+h]</span><script type="math/tex">x \in [a-h,a+h]</script></span> and we see the result.</p>
<hr />
<h2 id="scipymiscderivative">scipy.misc.derivative</h2>
<p>The <a href="https://scipy.org/">SciPy</a> function <code>scipy.misc.derivative</code> computes derivatives using the central difference formula.</p>
<pre><code class="python">from scipy.misc import derivative
</code></pre>

<pre><code class="python">x = np.arange(0,5)
derivative(np.exp,x,dx=0.1)
</code></pre>

<div class="highlight"><pre><span></span><code>array([ 1.0016675 ,  2.72281456,  7.40137735, 20.11902956, 54.68919246])
</code></pre></div>

<h2 id="higher-order-derivatives">Higher Order Derivatives</h2>
<p><em>Under construction</em></p>
<h2 id="examples">Examples</h2>
<h3 id="taylor-series">Taylor series</h3>
<p>Let's plot the Taylor polynomial <span><span class="MathJax_Preview">T_3(x)</span><script type="math/tex">T_3(x)</script></span> of degree 3 centered at <span><span class="MathJax_Preview">x=0</span><script type="math/tex">x=0</script></span> for <span><span class="MathJax_Preview">f(x) = \frac{3e^x}{x^2 + x + 1}</span><script type="math/tex">f(x) = \frac{3e^x}{x^2 + x + 1}</script></span> over the interval <span><span class="MathJax_Preview">x \in [-3,3]</span><script type="math/tex">x \in [-3,3]</script></span>. First, let's plot the graph <span><span class="MathJax_Preview">y=f(x)</span><script type="math/tex">y=f(x)</script></span>:</p>
<pre><code class="python">x = np.linspace(-3,3,100)
f = lambda x: 3*np.exp(x) / (x**2 + x + 1)
y = f(x)
plt.plot(x,y);
plt.show()
</code></pre>

<p><img alt="png" src="../../nb_img/differentiation/differentiation_22_0.png" /></p>
<p>Let's compute the coefficients <span><span class="MathJax_Preview">a_n = \frac{f^{(n)}(0)}{n!}</span><script type="math/tex">a_n = \frac{f^{(n)}(0)}{n!}</script></span> for <span><span class="MathJax_Preview">n=0,1,2,3</span><script type="math/tex">n=0,1,2,3</script></span>:</p>
<pre><code class="python">a0 = f(0)
a1 = derivative(f,0,dx=0.001,n=1)
a2 = derivative(f,0,dx=0.001,n=2) / 2
a3 = derivative(f,0,dx=0.001,n=3,order=5) / 6
# The parameter order specifies the number of points to use
# The value order must be odd and at least n + 1

print(a0,a1,a2,a3)
</code></pre>

<div class="highlight"><pre><span></span><code>3.0 1.9999983891239026e-06 -1.50000037502096 1.9999920608526622
</code></pre></div>

<p>Finally, let's plot <span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> and <span><span class="MathJax_Preview">T_3(x)</span><script type="math/tex">T_3(x)</script></span> together:</p>
<pre><code class="python">T3 = a0 + a1*x + a2*x**2 + a3*x**3
plt.plot(x,y,x,T3), plt.xlim([-3,3]), plt.ylim([0,5]);
plt.show()
</code></pre>

<p><img alt="png" src="../../nb_img/differentiation/differentiation_26_0.png" /></p>
<h3 id="arc-length">Arc length</h3>
<p>Write a function called <code>arc_length</code> which takes parameters <code>f</code>, <code>a</code>, <code>b</code>, <code>h</code> and <code>N</code> and returns an approximation of the arc length of <span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> from <span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> to <span><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span></p>
<div>
<div class="MathJax_Preview">
L \approx \int_a^b \sqrt{ 1 + \left( f'(x) \right)^2 } dx
</div>
<script type="math/tex; mode=display">
L \approx \int_a^b \sqrt{ 1 + \left( f'(x) \right)^2 } dx
</script>
</div>
<p>The function uses the trapezoid rule (<code>scipy.integrate.trapz</code>) to estimate the integral and the central difference formula to approximate <span><span class="MathJax_Preview">f'(x)</span><script type="math/tex">f'(x)</script></span>. Note that we can't use the central difference formula at the endpoints because they use <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> values outside the interval <span><span class="MathJax_Preview">[a,b]</span><script type="math/tex">[a,b]</script></span> and our function may not be defined there.</p>
<pre><code class="python">import scipy.integrate as spi

def arc_length(f,a,b,h=0.001,N=1000):
    '''Approximate the arc length of y=f(x) from x=a to x=b.

    Parameters
    ----------
    f : (vectorized) function of one variable
    a,b : numbers defining the interval [a,b]
    h : step size to use in difference formulas
    N : number of subintervals in trapezoid method

    Returns
    -------
    Approximation of the integral \int_a^b \sqrt{1 + (f'(x))^2} dx
    representing the arc length of y=f(x) from x=a to x=b.
    '''
    x = np.linspace(a,b,N+1)
    y = f(x)

    # Compute central difference formula for x_k for 1 &amp;lt;= k &amp;lt;= N-1
    h = np.min([h,(b-a)/N]) # Make sure that h is smaller than the size of the subintervals
    x_interior = x[1:-1]
    df_interior = (f(x_interior + h) - f(x_interior - h))/(2*h)

    # Use forward/backward difference formula at the endpoints
    df_a = (f(a + h) - f(a))/h
    df_b = (f(b) - f(b - h))/h
    df = np.hstack([[df_a],df_interior,[df_b]])

    # Compute values of the integrand in arc length formula
    y = np.sqrt(1 + df**2)

    # Compute the integral
    L = spi.trapz(y,x)

    return L
</code></pre>

<p>Let's test our function with input where we know the exact output. For example, the arc length of <span><span class="MathJax_Preview">f(x)=x</span><script type="math/tex">f(x)=x</script></span> from <span><span class="MathJax_Preview">a=0</span><script type="math/tex">a=0</script></span> to <span><span class="MathJax_Preview">b=1</span><script type="math/tex">b=1</script></span> is <span><span class="MathJax_Preview">L=\sqrt{2}</span><script type="math/tex">L=\sqrt{2}</script></span> and we compute</p>
<pre><code class="python">arc_length(lambda x: x,0,1)
</code></pre>

<div class="highlight"><pre><span></span><code>1.4142135623730958
</code></pre></div>

<p>and compare with the exact value</p>
<pre><code class="python">np.sqrt(2)
</code></pre>

<div class="highlight"><pre><span></span><code>1.4142135623730951
</code></pre></div>

<p>The arc length of <span><span class="MathJax_Preview">f(x)=\sqrt{1 - x^2}</span><script type="math/tex">f(x)=\sqrt{1 - x^2}</script></span> from <span><span class="MathJax_Preview">a=0</span><script type="math/tex">a=0</script></span> to <span><span class="MathJax_Preview">b=\frac{1}{\sqrt{2}}</span><script type="math/tex">b=\frac{1}{\sqrt{2}}</script></span> is <span><span class="MathJax_Preview">L=\frac{\pi}{4}</span><script type="math/tex">L=\frac{\pi}{4}</script></span> and we compute</p>
<pre><code class="python">arc_length(lambda x: np.sqrt(1 - x**2),0,1/np.sqrt(2))
</code></pre>

<div class="highlight"><pre><span></span><code>0.7853980801486478
</code></pre></div>

<p>and compare to the exact value</p>
<pre><code class="python">np.pi/4
</code></pre>

<div class="highlight"><pre><span></span><code>0.7853981633974483
</code></pre></div>

<p>The arc length of <span><span class="MathJax_Preview">f(x)=\frac{2x^{3/2}}{3}</span><script type="math/tex">f(x)=\frac{2x^{3/2}}{3}</script></span> from <span><span class="MathJax_Preview">a=0</span><script type="math/tex">a=0</script></span> to <span><span class="MathJax_Preview">b=1</span><script type="math/tex">b=1</script></span> is <span><span class="MathJax_Preview">L = \frac{2}{3}\left( 2^{3/2} - 1 \right)</span><script type="math/tex">L = \frac{2}{3}\left( 2^{3/2} - 1 \right)</script></span> and we compute</p>
<pre><code class="python">arc_length(lambda x: 2*(x**(3/2))/3,0,1,h=10**(-10),N=10**5)
</code></pre>

<div class="highlight"><pre><span></span><code>1.2189514473615233
</code></pre></div>

<p>and compare to the exact value</p>
<pre><code class="python">(2/3)*(2**(3/2) - 1)
</code></pre>

<div class="highlight"><pre><span></span><code>1.2189514164974602
</code></pre></div>

<h2 id="exercises">Exercises</h2>
<ol>
<li>
<p>Use <code>derivative</code> to compute values and then plot the derivative <span><span class="MathJax_Preview">f'(x)</span><script type="math/tex">f'(x)</script></span> of the function</p>
<div>
<div class="MathJax_Preview">
f(x) = \frac{7x^3-5x+1}{2x^4+x^2+1} \ , \ x \in [-5,5]
</div>
<script type="math/tex; mode=display">
f(x) = \frac{7x^3-5x+1}{2x^4+x^2+1} \ , \ x \in [-5,5]
</script>
</div>
<p>Compute the derivative of <span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> by hand (using the quotient rule), plot the formula for <span><span class="MathJax_Preview">f'(x)</span><script type="math/tex">f'(x)</script></span> and compare to the numerical approximation above.</p>
</li>
<li>
<p>Plot the Taylor polynomial <span><span class="MathJax_Preview">T_4(x)</span><script type="math/tex">T_4(x)</script></span> of degree 4 centered at <span><span class="MathJax_Preview">x=0</span><script type="math/tex">x=0</script></span> of the function</p>
<div>
<div class="MathJax_Preview">
f(x) = \cos(x) + \sin(2x)
</div>
<script type="math/tex; mode=display">
f(x) = \cos(x) + \sin(2x)
</script>
</div>
<p>over the interval <span><span class="MathJax_Preview">x \in [-\pi,\pi]</span><script type="math/tex">x \in [-\pi,\pi]</script></span>.</p>
</li>
</ol>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../differential-equations/first-order/" title="First Order Equations" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                First Order Equations
              </div>
            </div>
          </a>
        
        
          <a href="../../integration/integrals/" title="Definite Integrals" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Definite Integrals
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.d710d30a.min.js"></script>
      <script src="../../assets/javascripts/bundle.b39636ac.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../javascripts/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../../javascripts/highlight.js"></script>
      
    
  </body>
</html>